@{
	IEnumerable<DeftOData.DEFT_CompanyActivitiesCard> activeNoticeQuery = ViewBag.ActiveNoticeQuery;
	IEnumerable<DeftOData.DEFT_CompanyActivitiesCard> recalledNoticeQuery = ViewBag.RecalledNoticeQuery;
	IEnumerable<DeftOData.DEFT_CompanyActivitiesCard> elapsedNoticeQuery = ViewBag.ElapsedNoticeQuery;


	DeftOData.DEFT_EmployeeCard employeeCard = ViewBag.DEFT_EmployeeCard;

	string Dept = employeeCard.Global_Dimension_1_Code;

	DateTime Today = DateTime.Now;

	bool showItem = true;
}

@section AppStyles {
	<!-- Responsive Table css -->
	<link href="~/assets/libs/admin-resources/rwd-table/rwd-table.min.css" rel="stylesheet" type="text/css" />

}
<!-- start page title -->
<div class="row">
	<div class="col-12">
		<div class="page-title-box d-flex align-items-center justify-content-between">
			<h4 class="mb-0">Notice Board</h4>

			<div class="page-title-right">
				<ol class="breadcrumb m-0">
					<li class="breadcrumb-item"><a href="javascript: void(0);">ESS</a></li>
					<li class="breadcrumb-item active">Notice Board</li>
				</ol>
			</div>

		</div>
	</div>
</div>
<!-- end page title -->

<div class="row mb-4">
	<div class="col-xl-12">
		<div class="card">
			<div class="card-body">

				<!-- Nav tabs -->
				<ul class="nav nav-tabs nav-tabs-custom nav-justified" role="tablist">
					<li class="nav-item">
						<a class="nav-link active" data-bs-toggle="tab" href="#active" role="tab">
							<span class="d-block d-sm-none"><i class="fa fa-home"></i></span>
							<span class="d-none d-sm-block">Active Notices</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" data-bs-toggle="tab" href="#recalled" role="tab">
							<span class="d-block d-sm-none"><i class="fa fa-user"></i></span>
							<span class="d-none d-sm-block">Recalled Notices</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" data-bs-toggle="tab" href="#elapsed" role="tab">
							<span class="d-block d-sm-none"><i class="fa fa-envelope"></i></span>
							<span class="d-none d-sm-block">Elapsed Notices</span>
						</a>
					</li>
				</ul>

				<!-- Tab panes -->
				<div class="tab-content p-3 text-muted">
					<div class="tab-pane active" id="active" role="tabpanel">

						<div class="table-rep-plugin">
							<div class="table-responsive mb-0" data-pattern="priority-columns">
								<table class="table table-striped">
									<thead>
										<tr>
											<th>Code</th>
											<th>Description</th>
											<th>Day</th>
											<th>Venue</th>
											<th>Action</th>
										</tr>
									</thead>
									<tbody>
										@foreach (var item in activeNoticeQuery)
										{
											{
												showItem = true;

												if (item.Specific_Department ?? false)
												{
													if (!Dept.Equals(item.Department))
													{
														showItem = false;
													}
												}

												if (item.Valid_Till != null)
												{

													if (Today > item.Valid_Till)
													{
														showItem = false;
													}

												}
											}

											@if (showItem)
											{
												<tr>
													<td>@item.Code</td>
													<td>@item.Description</td>
													<td>@item.Valid_Till</td>
													<td>@item.Venue</td>
													<td>
														<a asp-action="Details" asp-route-No="@item.Code">Details</a>
													</td>
												</tr>
											}
										}
									</tbody>
								</table>
							</div>
						</div>

					</div>
					<div class="tab-pane" id="recalled" role="tabpanel">

						<div class="table-rep-plugin">
							<div class="table-responsive mb-0" data-pattern="priority-columns">
								<table class="table table-striped">
									<thead>
										<tr>
											<th>Code</th>
											<th>Description</th>
											<th>Day</th>
											<th>Venue</th>
											<th>Action</th>
										</tr>
									</thead>
									<tbody>
										@foreach (var item in recalledNoticeQuery)
										{
											{
												showItem = true;

												if (item.Specific_Department ?? false)
												{
													if (!Dept.Equals(item.Department))
													{
														showItem = false;
													}
												}

												if (item.Valid_Till != null)
												{

													if (Today > item.Valid_Till)
													{
														showItem = false;
													}

												}
											}

											@if (showItem)
											{
												<tr>
													<td>@item.Code</td>
													<td>@item.Description</td>
													<td>@item.Valid_Till</td>
													<td>@item.Venue</td>
													<td>
														<a asp-action="Details" asp-route-No="@item.Code">Details</a>
													</td>
												</tr>
											}
										}
									</tbody>
								</table>
							</div>
						</div>

					</div>
					<div class="tab-pane" id="elapsed" role="tabpanel">

						<div class="table-rep-plugin">
							<div class="table-responsive mb-0" data-pattern="priority-columns">
								<table class="table table-striped">
									<thead>
										<tr>
											<th>Code</th>
											<th>Description</th>
											<th>Day</th>
											<th>Venue</th>
											<th>Action</th>
										</tr>
									</thead>
									<tbody>
										@foreach (var item in elapsedNoticeQuery)
										{
											{
												showItem = true;

												if (item.Specific_Department ?? false)
												{
													if (!Dept.Equals(item.Department))
													{
														showItem = false;
													}
												}

												if (item.Valid_Till != null)
												{

													if (Today > item.Valid_Till)
													{
														showItem = false;
													}

												}
											}

											@if (showItem)
											{
												<tr>
													<td>@item.Code</td>
													<td>@item.Description</td>
													<td>@item.Valid_Till</td>
													<td>@item.Venue</td>
													<td>
														<a asp-action="Details" asp-route-No="@item.Code">Details</a>
													</td>
												</tr>
											}
										}
									</tbody>
								</table>
							</div>
						</div>

					</div>
				</div>

			</div><!-- end card-body -->
		</div><!-- end card -->
	</div><!-- end col -->
</div>

@section AppScripts {

	<!-- Responsive Table js -->
	<script src="~/assets/libs/admin-resources/rwd-table/rwd-table.min.js"></script>

	<!-- Init js -->
	<script src="~/assets/js/pages/table-responsive.init.js"></script>

}